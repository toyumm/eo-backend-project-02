<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>마이페이지</title>
</head>
<body>

<h1>마이페이지</h1>

<div sec:authorize="isAuthenticated()">
    <p><span sec:authentication="name"></span>님 환영합니다</p>

    <h2>내 정보</h2>
    <p>아이디: <span th:text="${user.username}"></span></p>
    <p>이메일: <span th:text="${user.email}"></span></p>
    <p>닉네임: <span th:text="${user.nickname}"></span></p>
    <p>가입일: <span th:text="${#temporals.format(user.createdAt, 'yyyy-MM-dd')}"></span></p>

    <form th:action="@{/mypage/nickname}" method="post">
        <input type="text" name="nickname" placeholder="새 닉네임" required>
        <button type="submit">닉네임 변경</button>
    </form>

    <h2>비밀번호 변경</h2>

    <form th:action="@{/mypage/password}" method="post">
        <input type="password" name="currentPassword" placeholder="현재 비밀번호" required>
        <input type="password" name="newPassword" placeholder="새 비밀번호" required>
        <input type="password" name="newPasswordConfirm" placeholder="새 비밀번호 확인" required>
        <button type="submit">비밀번호 변경</button>
    </form>

    <p th:if="${message}" th:text="${message}"></p>
    <p th:if="${error}" th:text="${error}"></p>
</div>

<h2>내 활동</h2>
<a th:href="@{/mypage/posts}">내 게시글 보기</a>
<a th:href="@{/mypage/comments}">내 댓글 보기</a>

<form th:action="@{/mypage/removeAccount}" method="post"
      onsubmit="return confirm('정말 탈퇴하시겠습니까?');">
    <button type="submit">회원 탈퇴</button>
</form>

</body>
</html>